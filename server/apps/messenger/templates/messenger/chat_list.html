{% extends "base.html" %}

{% load static i18n %}

{% block title %}
  {% trans "Chats" %}
{% endblock title %}
{% block links %}
  <link rel="stylesheet" href="{% static 'css/avatar_preview.css' %}"/>
{% endblock links %}
{% block content %}
  <div class="row justify-content-center">
    <div class="col-xl-6">
      {% for chat, companion in chats %}
        <div class="card mb-2">
          <a href="{{ chat.get_absolute_url }}"
             class="text-decoration-none text-dark">
            <div class="card-body">
              <div class="row align-items-center">
                <div class="avatar-preview">
                  {% if companion.image %}
                    <img class="rounded" alt="" loading="lazy" src="{{ companion.image.url }}"/>
                  {% endif %}
                </div>
                <div class="col ms-2 d-flex justify-content-between align-items-center">
                  <div class="text-break">
                    {{ companion.get_username }}
                    {{ companion.full_name_in_brackets }}
                    {% if chat.last_message %}
                      <div class="text-secondary">{{ chat.last_message.text|truncatechars:30 }}</div>
                    {% endif %}
                  </div>
                  {% if chat.last_message %}
                    <div class="text-secondary">{{ chat.last_message.date }}</div>
                  {% endif %}
                </div>
              </div>
            </div>
          </a>
        </div>
      {% empty %}
        <div class="card">
          <div class="card-body">
            <div class="text-center">{% trans "You have no chats." %}</div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock content %}
